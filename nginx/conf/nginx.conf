worker_processes  1;
error_log logs/error.log error;
events {
    worker_connections 1024;
}

http {
    lua_shared_dict cache_ngx 1m;
    lua_package_path '/home/samuel/openresty/nginx/lua/?.lua;;';


    server {
        listen 8080;

        lua_code_cache on;

        location ~ ^/api/([\w_]+) {
            set $path $1;
            content_by_lua_file lua/$path.lua;
        }

        location /foo {
            set $a 32;
            set $b 56;

            set_by_lua $sum
                'return tonumber(ngx.arg[1]) + tonumber(ngx.arg[2])'
                $a $b;

            echo $sum;
        }

    }

}
